<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Bitboards in Rust | rv178</title><meta name=keywords content="bitboards,chess,chess-engine,rust"><meta name=description content="Introduction Hello there! I haven&rsquo;t posted in a while because I was working on my chess engine. Specifically, representing the pieces as bitboards. Now you may ask what a bitboard is. You can use bitboards to represent a chess board in a piece-centric manner. What is so special about bitboards then? Doesn&rsquo;t a piece list do the same thing? Well, representing a bitboard only requires a single unsigned 64 bit integer!"><meta name=author content><link rel=canonical href=https://rv178.is-a.dev/posts/bitboards-in-rust/><link crossorigin=anonymous href=/assets/css/stylesheet.29a7535ae3148c25cfd9661c085d5568afc290dd9abd041803f5964043035889.css integrity="sha256-KadTWuMUjCXP2WYcCF1VaK/CkN2avQQYA/WWQEMDWIk=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://raw.githubusercontent.com/rv178/website/main/static/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://raw.githubusercontent.com/rv178/website/main/static/favicon.png><link rel=icon type=image/png sizes=32x32 href=https://raw.githubusercontent.com/rv178/website/main/static/favicon.png><link rel=apple-touch-icon href=https://raw.githubusercontent.com/rv178/website/main/static/favicon.png><link rel=mask-icon href=https://raw.githubusercontent.com/rv178/website/main/static/favicon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Bitboards in Rust"><meta property="og:description" content="Introduction Hello there! I haven&rsquo;t posted in a while because I was working on my chess engine. Specifically, representing the pieces as bitboards. Now you may ask what a bitboard is. You can use bitboards to represent a chess board in a piece-centric manner. What is so special about bitboards then? Doesn&rsquo;t a piece list do the same thing? Well, representing a bitboard only requires a single unsigned 64 bit integer!"><meta property="og:type" content="article"><meta property="og:url" content="https://rv178.is-a.dev/posts/bitboards-in-rust/"><meta property="og:image" content="https://raw.githubusercontent.com/rv178/website/main/static/favicon.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-28T21:46:16+05:30"><meta property="article:modified_time" content="2022-09-28T21:46:16+05:30"><meta property="og:site_name" content="rv178"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://raw.githubusercontent.com/rv178/website/main/static/favicon.png"><meta name=twitter:title content="Bitboards in Rust"><meta name=twitter:description content="Introduction Hello there! I haven&rsquo;t posted in a while because I was working on my chess engine. Specifically, representing the pieces as bitboards. Now you may ask what a bitboard is. You can use bitboards to represent a chess board in a piece-centric manner. What is so special about bitboards then? Doesn&rsquo;t a piece list do the same thing? Well, representing a bitboard only requires a single unsigned 64 bit integer!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://rv178.is-a.dev/posts/"},{"@type":"ListItem","position":3,"name":"Bitboards in Rust","item":"https://rv178.is-a.dev/posts/bitboards-in-rust/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Bitboards in Rust","name":"Bitboards in Rust","description":"Introduction Hello there! I haven\u0026rsquo;t posted in a while because I was working on my chess engine. Specifically, representing the pieces as bitboards. Now you may ask what a bitboard is. You can use bitboards to represent a chess board in a piece-centric manner. What is so special about bitboards then? Doesn\u0026rsquo;t a piece list do the same thing? Well, representing a bitboard only requires a single unsigned 64 bit integer!","keywords":["bitboards","chess","chess-engine","rust"],"articleBody":" Introduction Hello there! I haven’t posted in a while because I was working on my chess engine. Specifically, representing the pieces as bitboards. Now you may ask what a bitboard is. You can use bitboards to represent a chess board in a piece-centric manner. What is so special about bitboards then? Doesn’t a piece list do the same thing? Well, representing a bitboard only requires a single unsigned 64 bit integer!\nAs taken from the chessprogramming wiki:\nTo represent the board we typically need one bitboard for each piece-type and color - likely encapsulated inside a class or structure, or as an array of bitboards as part of a position object. A one-bit inside a bitboard implies the existence of a piece of this piece-type on a certain square - one to one associated by the bit-position.\nFor example, a bitboard containing all of white’s pawns in the starting position would look like this:\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 1 1 1 1 1 1 1 . . . . . . . . As you can observe, the squares containing the pawns have a value of 1 and others have a value of 0. A bitboard representing a particular piece will have 1 in the squares the piece occupies and 0 in all the other squares.\nBefore proceding further, I’d like to shed light on the fact that I’m fairly new to the chess engine development scene, so all suggestions are welcome!\nImplementation I decided to go with representing all the bitboards in a single position as a struct.\n#[derive(Debug, Clone)] struct BitPos { wp: BitBoard, // white pawns wn: BitBoard, // white knights wb: BitBoard, // white bishops wr: BitBoard, // white rooks wq: BitBoard, // white queen wk: BitBoard, // white king bp: BitBoard, // black pawns bn: BitBoard, // black knights bb: BitBoard, // black bishops br: BitBoard, // black rooks bq: BitBoard, // black queen bk: BitBoard, // black king } BitBoard is a struct containing a u64.\n#[derive(Debug, Clone, Copy, PartialEq, Eq)] struct BitBoard(pub u64); Then I wrote a simple function to generate a bitboard from my piece list array (see fen-string-parsing-in-rust)\nfn gen(pieces: \u0026mut [Option\u003cPiece\u003e; 64], compare: char) -\u003e Self { let mut bin_str = String::new(); // reverse pieces array pieces.reverse(); for piece in pieces { if let Some(piece) = piece { if !(piece.symbol == compare) { bin_str.push('0'); } else { bin_str.push('1'); } } else { bin_str.push('0'); } } // convert binary string to decimal (u64) Self(u64::from_str_radix(\u0026bin_str, 2).unwrap()) } And another function to print out the bitboard:\nfn print(\u0026self) { println!(\"Value: {}\", \u0026self.0); println!(); let mut x = 8; for rank in 0..8 { print!(\"\\x1b[34m{}\\x1b[0m \", x); x -= 1; for file in 0..8 { let square = rank * 8 + file; if self.0 \u0026 (1 \u003c\u003c square) \u003e= 1 { print!(\"\\x1b[1m1\\x1b[0m \"); } else { print!(\"\\x1b[38;5;8m0\\x1b[0m \"); } } println!(); } println!(); println!(\"\\x1b[34m a b c d e f g h\\x1b[0m\"); println!(); } And some other functions for convenience:\n// generate bitboard from square fn from_sq(square: Square) -\u003e Self { Self(1 \u003c\u003c square as u8) } // init empty bitboard fn empty() -\u003e Self { Self(0) } // set bit at given square (0 -\u003e 1) fn set_bit(\u0026mut self, square: Square) { self.0 |= BitBoard::from_sq(square).0; } // toggle bit at given square fn toggle_bit(\u0026mut self, square: Square) { self.0 ^= BitBoard::from_sq(square).0; } What fascinated me is the fact that how easy it was to perform actions on bitboards.\nI also made an enum to represent the squares (just for convenience and better code readability).\n// to represent squares #[rustfmt::skip] #[derive(Copy, Clone, Debug, PartialEq, Eq)] enum Square { A8, B8, C8, D8, E8, F8, G8, H8, A7, B7, C7, D7, E7, F7, G7, H7, A6, B6, C6, D6, E6, F6, G6, H6, A5, B5, C5, D5, E5, F5, G5, H5, A4, B4, C4, D4, E4, F4, G4, H4, A3, B3, C3, D3, E3, F3, G3, H3, A2, B2, C2, D2, E2, F2, G2, H2, A1, B1, C1, D1, E1, F1, G1, H1, } Piece attack generation I found this very interesting. I still haven’t finished working on move generation for sliding pieces at the time of writing this.\nAnyways, for generating pawn attacks, you can shift the bitboard by 7 and 9 in specific directions to achieve the desired result. That is, capturing diagonally.\nFor example:\nconst NOT_A_FILE: BitBoard = BitBoard(18374403900871474942); const NOT_H_FILE: BitBoard = BitBoard(9187201950435737471); pub fn east(board: BitBoard, colour: Colour) -\u003e BitBoard { match colour { Colour::White =\u003e BitBoard((board.0 \u003e\u003e 9) \u0026 NOT_H_FILE.0), Colour::Black =\u003e BitBoard((board.0 \u003c\u003c 9) \u0026 NOT_A_FILE.0), Colour::Undefined =\u003e exit(1), } } pub fn west(board: BitBoard, colour: Colour) -\u003e BitBoard { match colour { Colour::White =\u003e BitBoard((board.0 \u003e\u003e 7) \u0026 NOT_A_FILE.0), Colour::Black =\u003e BitBoard((board.0 \u003c\u003c 7) \u0026 NOT_H_FILE.0), Colour::Undefined =\u003e exit(1), } } I also a made a function for convenience (lookup pawn attacks for a particular square):\npub fn lookup(square: Square, colour: Colour) -\u003e BitBoard { let board = BitBoard::from_sq(square); match colour { Colour::White =\u003e BitBoard(east(board, Colour::White).0 | west(board, Colour::White).0), Colour::Black =\u003e BitBoard(east(board, Colour::Black).0 | west(board, Colour::Black).0), Colour::Undefined =\u003e exit(1), } } And another one for all pawns:\npub fn all(board: BitBoard, colour: Colour) -\u003e BitBoard { match colour { Colour::White =\u003e BitBoard(east(board, Colour::White).0 | west(board, Colour::White).0), Colour::Black =\u003e BitBoard(east(board, Colour::Black).0 | west(board, Colour::Black).0), Colour::Undefined =\u003e exit(1), } } Attacks can be generated in the same manner for knights and kings:\nKnights noNoWe noNoEa +15 +17 | | noWeWe +6 __| |__+10 noEaEa \\ / \u003e0\u003c __ / \\ __ soWeWe -10 | | -6 soEaEa | | -17 -15 soSoWe soSoEa const NOT_HG_FILE: BitBoard = BitBoard(4557430888798830399); const NOT_AB_FILE: BitBoard = BitBoard(18229723555195321596); pub fn no_no_east(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003c\u003c 17) \u0026 NOT_A_FILE.0) } pub fn no_no_west(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003c\u003c 15) \u0026 NOT_H_FILE.0) } pub fn so_so_east(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003e\u003e 15) \u0026 NOT_A_FILE.0) } pub fn so_so_west(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003e\u003e 17) \u0026 NOT_H_FILE.0) } pub fn no_ea_east(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003c\u003c 10) \u0026 NOT_AB_FILE.0) } pub fn so_ea_east(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003e\u003e 6) \u0026 NOT_AB_FILE.0) } pub fn no_we_west(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003c\u003c 6) \u0026 NOT_HG_FILE.0) } pub fn so_we_west(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003e\u003e 10) \u0026 NOT_HG_FILE.0) } // and then just get the union of all the other boards pub fn knight(sq: Square) -\u003e BitBoard { let board = BitBoard::from_sq(sq); let no_no_east = knight::no_no_east(board); let no_no_west = knight::no_no_west(board); let so_so_east = knight::so_so_east(board); let so_so_west = knight::so_so_west(board); let no_ea_east = knight::no_ea_east(board); let so_ea_east = knight::so_ea_east(board); let no_we_west = knight::no_we_west(board); let so_we_west = knight::so_we_west(board); BitBoard( no_no_east.0 | no_no_west.0 | so_so_east.0 | so_so_west.0 | no_ea_east.0 | so_ea_east.0 | no_we_west.0 | so_we_west.0, ) } Result (knight on e4):\n8 . . . . . . . . 7 . . . . . . . . 6 . . . 1 . 1 . . 5 . . 1 . . . 1 . 4 . . . . . . . . 3 . . 1 . . . 1 . 2 . . . 1 . 1 . . 1 . . . . . . . . a b c d e f g h King // north pub fn no(board: BitBoard) -\u003e BitBoard { BitBoard(board.0 \u003c\u003c 8) } // south pub fn so(board: BitBoard) -\u003e BitBoard { BitBoard(board.0 \u003e\u003e 8) } // east pub fn ea(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003c\u003c 1) \u0026 NOT_A_FILE.0) } // west pub fn we(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003e\u003e 1) \u0026 NOT_H_FILE.0) } // north east pub fn no_ea(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003c\u003c 9) \u0026 NOT_A_FILE.0) } // north west pub fn no_we(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003c\u003c 7) \u0026 NOT_H_FILE.0) } // south east pub fn so_ea(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003e\u003e 7) \u0026 NOT_A_FILE.0) } // south west pub fn so_we(board: BitBoard) -\u003e BitBoard { BitBoard((board.0 \u003e\u003e 9) \u0026 NOT_H_FILE.0) } pub fn king(sq: Square) -\u003e BitBoard { let board = BitBoard::from_sq(sq); let no = king::no(board); let so = king::so(board); let ea = king::ea(board); let we = king::we(board); let no_ea = king::no_ea(board); let no_we = king::no_we(board); let so_ea = king::so_ea(board); let so_we = king::so_we(board); BitBoard(no.0 | so.0 | ea.0 | we.0 | no_ea.0 | no_we.0 | so_ea.0 | so_we.0) } Result (king on e4):\n8 . . . . . . . . 7 . . . . . . . . 6 . . . . . . . . 5 . . . 1 1 1 . . 4 . . . 1 . 1 . . 3 . . . 1 1 1 . . 2 . . . . . . . . 1 . . . . . . . . a b c d e f g h That’s it for this blog, see you soon!\nReferences chessprogramming.org/Bitboards Chess engine in C ","wordCount":"1519","inLanguage":"en","datePublished":"2022-09-28T21:46:16+05:30","dateModified":"2022-09-28T21:46:16+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"https://rv178.is-a.dev/posts/bitboards-in-rust/"},"publisher":{"@type":"Organization","name":"rv178","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/rv178/website/main/static/favicon.png"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><ul id=menu><li><a href=https://rv178.is-a.dev/ title=Home><span>Home</span></a></li><li><a href=https://rv178.is-a.dev/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://rv178.is-a.dev/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul><div class=logo><a href=https://rv178.is-a.dev accesskey=h title="  (Alt + H)"></a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://rv178.is-a.dev>Home</a>&nbsp;»&nbsp;<a href=https://rv178.is-a.dev/posts/>Posts</a></div><h1 class=post-title>Bitboards in Rust</h1><div class=post-meta><span title='2022-09-28 21:46:16 +0530 +0530'>September 28, 2022</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1519 words</div></header><div class=post-content><hr><h3 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h3><p>Hello there! I haven&rsquo;t posted in a while because I was working on my chess engine. Specifically, representing the pieces as
bitboards. Now you may ask what a bitboard is. You can use bitboards to represent a chess board in a piece-centric manner.
What is so special about bitboards then? Doesn&rsquo;t a piece list do the same thing? Well, representing a bitboard only requires a
single unsigned 64 bit integer!</p><p>As taken from the <a href=https://www.chessprogramming.org/>chessprogramming wiki</a>:</p><blockquote><p>To represent the board we typically need one bitboard for each piece-type and color -
likely encapsulated inside a class or structure, or as an array of bitboards as part of a position object.
A one-bit inside a bitboard implies the existence of a piece of this piece-type on a certain square - one to
one associated by the bit-position.</p></blockquote><p>For example, a bitboard containing all of white&rsquo;s pawns in the starting position would look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>. . . . . . . .
</span></span><span style=display:flex><span>. . . . . . . .
</span></span><span style=display:flex><span>. . . . . . . .
</span></span><span style=display:flex><span>. . . . . . . .
</span></span><span style=display:flex><span>. . . . . . . .
</span></span><span style=display:flex><span>. . . . . . . .
</span></span><span style=display:flex><span>1 1 1 1 1 1 1 1
</span></span><span style=display:flex><span>. . . . . . . .
</span></span></code></pre></div><p>As you can observe, the squares containing the pawns have a value of 1 and others have a value of 0. A bitboard representing a
particular piece will have 1 in the squares the piece occupies and 0 in all the other squares.</p><p>Before proceding further, I&rsquo;d like to shed light on the fact that I&rsquo;m fairly new to the chess engine development scene, so all suggestions
are welcome!</p><h3 id=implementation>Implementation<a hidden class=anchor aria-hidden=true href=#implementation>#</a></h3><p>I decided to go with representing all the bitboards in a single position as a <code>struct</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>#[derive(Debug, Clone)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>BitPos</span> {
</span></span><span style=display:flex><span>	wp: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// white pawns
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	wn: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// white knights
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	wb: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// white bishops
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	wr: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// white rooks
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	wq: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// white queen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	wk: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// white king
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	bp: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// black pawns
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	bn: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// black knights
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	bb: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// black bishops
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	br: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// black rooks
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	bq: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// black queen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	bk: <span style=color:#a6e22e>BitBoard</span>, <span style=color:#75715e>// black king
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>BitBoard is a struct containing a u64.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>#[derive(Debug, Clone, Copy, PartialEq, Eq)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>BitBoard</span>(<span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>u64</span>);
</span></span></code></pre></div><p>Then I wrote a simple function to generate a bitboard from my piece list array
(see <a href=https://rv178.is-a.dev/posts/fen-string-parsing-in-rust/>fen-string-parsing-in-rust</a>)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>gen</span>(pieces: <span style=color:#66d9ef>&amp;</span><span style=color:#a6e22e>mut</span> [Option<span style=color:#f92672>&lt;</span>Piece<span style=color:#f92672>&gt;</span>; <span style=color:#ae81ff>64</span>], compare: <span style=color:#66d9ef>char</span>) -&gt; <span style=color:#a6e22e>Self</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> bin_str <span style=color:#f92672>=</span> String::new();
</span></span><span style=display:flex><span>    <span style=color:#75715e>// reverse pieces array
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    pieces.reverse();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> piece <span style=color:#66d9ef>in</span> pieces {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> Some(piece) <span style=color:#f92672>=</span> piece {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>!</span>(piece.symbol <span style=color:#f92672>==</span> compare) {
</span></span><span style=display:flex><span>                bin_str.push(<span style=color:#e6db74>&#39;0&#39;</span>);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                bin_str.push(<span style=color:#e6db74>&#39;1&#39;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            bin_str.push(<span style=color:#e6db74>&#39;0&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// convert binary string to decimal (u64)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Self(<span style=color:#66d9ef>u64</span>::from_str_radix(<span style=color:#f92672>&amp;</span>bin_str, <span style=color:#ae81ff>2</span>).unwrap())
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And another function to print out the bitboard:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>print</span>(<span style=color:#f92672>&amp;</span>self) {
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;Value: </span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#34;</span>, <span style=color:#f92672>&amp;</span>self.<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    println!();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#66d9ef>mut</span> x <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> rank <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>..</span><span style=color:#ae81ff>8</span> {
</span></span><span style=display:flex><span>        print!(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>[34m</span><span style=color:#e6db74>{}</span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>[0m  &#34;</span>, x);
</span></span><span style=display:flex><span>        x <span style=color:#f92672>-=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> file <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>..</span><span style=color:#ae81ff>8</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> square <span style=color:#f92672>=</span> rank <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>+</span> file;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> self.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> square) <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>1</span> {
</span></span><span style=display:flex><span>                print!(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>[1m1</span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>[0m &#34;</span>);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                print!(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>[38;5;8m0</span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>[0m &#34;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        println!();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    println!();
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>[34m   a b c d e f g h</span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>[0m&#34;</span>);
</span></span><span style=display:flex><span>    println!();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And some other functions for convenience:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>// generate bitboard from square
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>from_sq</span>(square: <span style=color:#a6e22e>Square</span>) -&gt; <span style=color:#a6e22e>Self</span> {
</span></span><span style=display:flex><span>    Self(<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> square <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>u8</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// init empty bitboard
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>empty</span>() -&gt; <span style=color:#a6e22e>Self</span> {
</span></span><span style=display:flex><span>    Self(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// set bit at given square (0 -&gt; 1)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>set_bit</span>(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> self, square: <span style=color:#a6e22e>Square</span>) {
</span></span><span style=display:flex><span>    self.<span style=color:#ae81ff>0</span> <span style=color:#f92672>|=</span> BitBoard::from_sq(square).<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// toggle bit at given square
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>toggle_bit</span>(<span style=color:#f92672>&amp;</span><span style=color:#66d9ef>mut</span> self, square: <span style=color:#a6e22e>Square</span>) {
</span></span><span style=display:flex><span>    self.<span style=color:#ae81ff>0</span> <span style=color:#f92672>^=</span> BitBoard::from_sq(square).<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>What fascinated me is the fact that how easy it was to perform actions on bitboards.</p><p>I also made an enum to represent the squares (just for convenience and better code readability).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#75715e>// to represent squares
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#[rustfmt::skip]</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#[derive(Copy, Clone, Debug, PartialEq, Eq)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>Square</span> {
</span></span><span style=display:flex><span>    A8, B8, C8, D8, E8, F8, G8, H8,
</span></span><span style=display:flex><span>    A7, B7, C7, D7, E7, F7, G7, H7,
</span></span><span style=display:flex><span>    A6, B6, C6, D6, E6, F6, G6, H6,
</span></span><span style=display:flex><span>    A5, B5, C5, D5, E5, F5, G5, H5,
</span></span><span style=display:flex><span>    A4, B4, C4, D4, E4, F4, G4, H4,
</span></span><span style=display:flex><span>    A3, B3, C3, D3, E3, F3, G3, H3,
</span></span><span style=display:flex><span>    A2, B2, C2, D2, E2, F2, G2, H2,
</span></span><span style=display:flex><span>    A1, B1, C1, D1, E1, F1, G1, H1,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=piece-attack-generation>Piece attack generation<a hidden class=anchor aria-hidden=true href=#piece-attack-generation>#</a></h3><p>I found this very interesting. I still haven&rsquo;t finished working on move generation for sliding pieces at the time of writing this.</p><p>Anyways, for generating pawn attacks, you can shift the bitboard by 7 and 9 in specific directions to achieve the desired result.
That is, capturing diagonally.</p><p>For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>NOT_A_FILE</span>: <span style=color:#a6e22e>BitBoard</span> <span style=color:#f92672>=</span> BitBoard(<span style=color:#ae81ff>18374403900871474942</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>NOT_H_FILE</span>: <span style=color:#a6e22e>BitBoard</span> <span style=color:#f92672>=</span> BitBoard(<span style=color:#ae81ff>9187201950435737471</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>east</span>(board: <span style=color:#a6e22e>BitBoard</span>, colour: <span style=color:#a6e22e>Colour</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>match</span> colour {
</span></span><span style=display:flex><span>        Colour::White <span style=color:#f92672>=&gt;</span> BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>9</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_H_FILE</span>.<span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>        Colour::Black <span style=color:#f92672>=&gt;</span> BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>9</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_A_FILE</span>.<span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>        Colour::Undefined <span style=color:#f92672>=&gt;</span> exit(<span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>west</span>(board: <span style=color:#a6e22e>BitBoard</span>, colour: <span style=color:#a6e22e>Colour</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>match</span> colour {
</span></span><span style=display:flex><span>        Colour::White <span style=color:#f92672>=&gt;</span> BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>7</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_A_FILE</span>.<span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>        Colour::Black <span style=color:#f92672>=&gt;</span> BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>7</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_H_FILE</span>.<span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>        Colour::Undefined <span style=color:#f92672>=&gt;</span> exit(<span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>I also a made a function for convenience (lookup pawn attacks for a particular square):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>lookup</span>(square: <span style=color:#a6e22e>Square</span>, colour: <span style=color:#a6e22e>Colour</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> board <span style=color:#f92672>=</span> BitBoard::from_sq(square);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>match</span> colour {
</span></span><span style=display:flex><span>        Colour::White <span style=color:#f92672>=&gt;</span> BitBoard(east(board, Colour::White).<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> west(board, Colour::White).<span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>        Colour::Black <span style=color:#f92672>=&gt;</span> BitBoard(east(board, Colour::Black).<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> west(board, Colour::Black).<span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>        Colour::Undefined <span style=color:#f92672>=&gt;</span> exit(<span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And another one for all pawns:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>all</span>(board: <span style=color:#a6e22e>BitBoard</span>, colour: <span style=color:#a6e22e>Colour</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>match</span> colour {
</span></span><span style=display:flex><span>        Colour::White <span style=color:#f92672>=&gt;</span> BitBoard(east(board, Colour::White).<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> west(board, Colour::White).<span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>        Colour::Black <span style=color:#f92672>=&gt;</span> BitBoard(east(board, Colour::Black).<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> west(board, Colour::Black).<span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>        Colour::Undefined <span style=color:#f92672>=&gt;</span> exit(<span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Attacks can be generated in the same manner for knights and kings:</p><h4 id=knights>Knights<a hidden class=anchor aria-hidden=true href=#knights>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>        noNoWe    noNoEa
</span></span><span style=display:flex><span>            +15  +17
</span></span><span style=display:flex><span>             |     |
</span></span><span style=display:flex><span>noWeWe  +6 __|     |__+10  noEaEa
</span></span><span style=display:flex><span>              \   /
</span></span><span style=display:flex><span>               &gt;0&lt;
</span></span><span style=display:flex><span>           __ /   \ __
</span></span><span style=display:flex><span>soWeWe -10   |     |   -6  soEaEa
</span></span><span style=display:flex><span>             |     |
</span></span><span style=display:flex><span>            -17  -15
</span></span><span style=display:flex><span>        soSoWe    soSoEa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>NOT_HG_FILE</span>: <span style=color:#a6e22e>BitBoard</span> <span style=color:#f92672>=</span> BitBoard(<span style=color:#ae81ff>4557430888798830399</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>NOT_AB_FILE</span>: <span style=color:#a6e22e>BitBoard</span> <span style=color:#f92672>=</span> BitBoard(<span style=color:#ae81ff>18229723555195321596</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>no_no_east</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>17</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_A_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>no_no_west</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>15</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_H_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>so_so_east</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>15</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_A_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>so_so_west</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>17</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_H_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>no_ea_east</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>10</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_AB_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>so_ea_east</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>6</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_AB_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>no_we_west</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>6</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_HG_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>so_we_west</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>10</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_HG_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// and then just get the union of all the other boards
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>knight</span>(sq: <span style=color:#a6e22e>Square</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> board <span style=color:#f92672>=</span> BitBoard::from_sq(sq);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> no_no_east <span style=color:#f92672>=</span> knight::no_no_east(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> no_no_west <span style=color:#f92672>=</span> knight::no_no_west(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> so_so_east <span style=color:#f92672>=</span> knight::so_so_east(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> so_so_west <span style=color:#f92672>=</span> knight::so_so_west(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> no_ea_east <span style=color:#f92672>=</span> knight::no_ea_east(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> so_ea_east <span style=color:#f92672>=</span> knight::so_ea_east(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> no_we_west <span style=color:#f92672>=</span> knight::no_we_west(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> so_we_west <span style=color:#f92672>=</span> knight::so_we_west(board);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    BitBoard(
</span></span><span style=display:flex><span>        no_no_east.<span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>|</span> no_no_west.<span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>|</span> so_so_east.<span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>|</span> so_so_west.<span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>|</span> no_ea_east.<span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>|</span> so_ea_east.<span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>|</span> no_we_west.<span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>|</span> so_we_west.<span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Result (knight on e4):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-md data-lang=md><span style=display:flex><span>8  . . . . . . . . 
</span></span><span style=display:flex><span>7  . . . . . . . . 
</span></span><span style=display:flex><span>6  . . . 1 . 1 . . 
</span></span><span style=display:flex><span>5  . . 1 . . . 1 . 
</span></span><span style=display:flex><span>4  . . . . . . . . 
</span></span><span style=display:flex><span>3  . . 1 . . . 1 . 
</span></span><span style=display:flex><span>2  . . . 1 . 1 . . 
</span></span><span style=display:flex><span>1  . . . . . . . . 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   a b c d e f g h
</span></span></code></pre></div><h4 id=king>King<a hidden class=anchor aria-hidden=true href=#king>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// north
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>no</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard(board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// south
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>so</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard(board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// east
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>ea</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_A_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// west
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>we</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_H_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// north east
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>no_ea</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>9</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_A_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// north west
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>no_we</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>7</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_H_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// south east
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>so_ea</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>7</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_A_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// south west
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>so_we</span>(board: <span style=color:#a6e22e>BitBoard</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    BitBoard((board.<span style=color:#ae81ff>0</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>9</span>) <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>NOT_H_FILE</span>.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>pub</span> <span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>king</span>(sq: <span style=color:#a6e22e>Square</span>) -&gt; <span style=color:#a6e22e>BitBoard</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> board <span style=color:#f92672>=</span> BitBoard::from_sq(sq);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> no <span style=color:#f92672>=</span> king::no(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> so <span style=color:#f92672>=</span> king::so(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> ea <span style=color:#f92672>=</span> king::ea(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> we <span style=color:#f92672>=</span> king::we(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> no_ea <span style=color:#f92672>=</span> king::no_ea(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> no_we <span style=color:#f92672>=</span> king::no_we(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> so_ea <span style=color:#f92672>=</span> king::so_ea(board);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> so_we <span style=color:#f92672>=</span> king::so_we(board);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    BitBoard(no.<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> so.<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> ea.<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> we.<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> no_ea.<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> no_we.<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> so_ea.<span style=color:#ae81ff>0</span> <span style=color:#f92672>|</span> so_we.<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Result (king on e4):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-md data-lang=md><span style=display:flex><span>8  . . . . . . . . 
</span></span><span style=display:flex><span>7  . . . . . . . . 
</span></span><span style=display:flex><span>6  . . . . . . . . 
</span></span><span style=display:flex><span>5  . . . 1 1 1 . . 
</span></span><span style=display:flex><span>4  . . . 1 . 1 . . 
</span></span><span style=display:flex><span>3  . . . 1 1 1 . . 
</span></span><span style=display:flex><span>2  . . . . . . . . 
</span></span><span style=display:flex><span>1  . . . . . . . . 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   a b c d e f g h
</span></span></code></pre></div><p>That&rsquo;s it for this blog, see you soon!</p><h3 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h3><ul><li><a href=https://www.chessprogramming.org/Bitboards>chessprogramming.org/Bitboards</a></li><li><a href="https://www.youtube.com/playlist?list=PLmN0neTso3Jxh8ZIylk74JpwfiWNI76Cs">Chess engine in C</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://rv178.is-a.dev/tags/bitboards/>bitboards</a></li><li><a href=https://rv178.is-a.dev/tags/chess/>chess</a></li><li><a href=https://rv178.is-a.dev/tags/chess-engine/>chess-engine</a></li><li><a href=https://rv178.is-a.dev/tags/rust/>rust</a></li></ul><nav class=paginav><a class=prev href=https://rv178.is-a.dev/posts/hyperbola-quintessence-in-rust/><span class=title>« Prev</span><br><span>Hyperbola Quintessence in Rust</span></a>
<a class=next href=https://rv178.is-a.dev/posts/yew-rs-with-tailwind/><span class=title>Next »</span><br><span>Yew.rs With TailwindCSS</span></a></nav></footer></article></main><footer class=footer><span>Copyright &copy; 2025 <a href=https://rv178.is-a.dev>rv178</a></span>
<span>| <a href=https://github.com/rv178/website rel=noopener target=_blank>Source code</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>